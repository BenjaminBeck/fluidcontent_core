{namespace flux=FluidTYPO3\Flux\ViewHelpers}
{namespace fcc=FluidTYPO3\FluidcontentCore\ViewHelpers}
{namespace v=Tx_Vhs_ViewHelpers}
<f:layout name="Default" />

<f:section name="Configuration">
	<flux:form id="image">
		<f:render partial="Properties/Header" arguments="{_all}" />
		<f:render partial="Properties/Container" arguments="{_all}" />
		<f:render partial="Properties/Images" arguments="{_all}" />
	</flux:form>
</f:section>

<f:section name="Preview">
	<v:resource.record.fal record="{record}" field="image" table="tt_content" as="images">
		<f:for each="{images}" as="image" iteration="iteration">
			<v:media.image src="{image.url}" treatIdAsReference="TRUE" alt="{image.id}" height="50" />
		</f:for>
	</v:resource.record.fal>
	<flux:widget.grid />
</f:section>

<f:section name="Main">
	<v:resource.record.fal record="{record}" field="image" table="tt_content" as="images">
		<f:for each="{images}" as="image" iteration="iteration">
			<fcc:tag name="{settings.caption.tagName}">
				<f:image src="{image.url}" treatIdAsReference="TRUE" alt="{image.id}"
				         width="{record.imagewidth -> v:or(alternative: '-1')}{f:if(condition: record.imagewidth, then: settings.scaleMode)}"
				         height="{record.imageheight -> v:or(alternative: '-1')}{f:if(condition: record.imageheight, then: settings.scaleMode)}" />
				<flux:content.render area="content{image.checksum}" />
			</fcc:tag>
		</f:for>
	</v:resource.record.fal>
</f:section>
